theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#A70D1F',
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#5d9ca5',
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#5d9ca5', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#4d4e6b', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#4d4e6b', space = "Lch",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#4d4e6b', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#F07241', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#F07241', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#2E5440', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#2E5440', space = "Lch",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#2E5440', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn_v2.tiff', width=120, height=80, units='mm', dpi=300)
ggsave('fig_venn/fig_venn_v2.png', width=120, height=80, units='mm', dpi=300, bg='white')
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#4D4E6B', space = "Lch",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#4D4E6B', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#4D4E6B', space = "Lch",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn_v2.tiff', width=120, height=80, units='mm', dpi=300)
ggsave('fig_venn/fig_venn_v2.png', width=120, height=80, units='mm', dpi=300, bg='white')
ggsave('fig_venn/fig_venn_v2.tiff', width=120, height=80, units='mm', dpi=300)
ggsave('fig_venn/fig_venn_v2.png', width=120, height=80, units='mm', dpi=300, bg='white')
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn_v2.tiff', width=120, height=80, units='mm', dpi=300)
ggsave('fig_venn/fig_venn_v2.png', width=120, height=80, units='mm', dpi=300, bg='white')
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#5D9CA5', high='#383846', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn_v2.tiff', width=120, height=80, units='mm', dpi=300)
ggsave('fig_venn/fig_venn_v2.png', width=120, height=80, units='mm', dpi=300, bg='white')
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn_v2.tiff', width=120, height=80, units='mm', dpi=300)
ggsave('fig_venn/fig_venn_v2.png', width=120, height=80, units='mm', dpi=300, bg='white')
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#DDDDDD', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
FFD28A
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#d5dcd8", high="#2e5440",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
library(tidyverse)
library(readr)
library(sf)
library(ggspatial)
library(cowplot)
# Import data
## Localities with astrats
table <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)
## LUT for astrat consolidation
dict <- readxl::read_excel("fig_archaeology/arch_strat_consol.xlsx",
sheet = "arch_strat_ROAD", skip = 1) %>% select(idarchstrat, consol26='new_a_strat for simple search list 2', consol40='new_a_strat for simple search list 1')
## tidy table
table <- table  %>%
separate(archaeological_stratigraphy.technocomplex, into=c('period',NA), sep='/', remove=F) %>%
filter(period %in% c('ESA','MSA','LSA','LP','MP','UP')) %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol26)) %>%
filter(!astrat.consol=='do not use') %>%
drop_na(c(locality.x, locality.y))
## split table
table1 <- table %>% filter(period %in% c('LSA','UP')) %>% mutate(period=factor(period, levels=c('UP','LSA')))
point1 <- st_as_sf(x = table1, coords = c('locality.x', 'locality.y'), crs = st_crs(4326))
table2 <- table %>% filter(period %in% c('MSA','MP'))
point2 <- st_as_sf(x = table2, coords = c('locality.x', 'locality.y'), crs = st_crs(4326))
table3 <- table %>% filter(period %in% c('ESA','LP'))
point3 <- st_as_sf(x = table3, coords = c('locality.x', 'locality.y'), crs = st_crs(4326))
## other relevant stuff
theme_pub <-  function(){
list(scale_fill_manual(name='Number of localities',
breaks = c('UP','LSA','MP','MSA','LP','ESA'),
values = c('#F07241','#A70D1F','#A59837','#2E5440','#5D9CA5','#4D4E6B'),
labels = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age')),
geom_bar(aes(fill=period, y=fct_rev(fct_infreq(astrat.consol)))),
geom_text(stat='count', aes(label=..count.., y=fct_rev(fct_infreq(astrat.consol))), hjust=-.1, size=2.8),
labs(x='Count', y='Technocomplex'),
scale_x_continuous(limits=c(0,300), expand = c(0,0)),
scale_y_discrete(labels = function(x) str_wrap(x, width = 20)),
theme_classic(),
theme(#legend.position='bottom',
legend.justification = c(1, 0), legend.position = c(0.99, 0.01),
text=element_text(size=8), #change font size of all text
axis.text.x=element_text(size=8), #change font size of axis text
axis.text.y=element_text(size=8, color='black'), #change font size of axis text
axis.title.x=element_text(size=8), #change font size of axis titles
axis.title.y=element_blank(), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8)
))
}
theme_map <-  function(){
list(scale_fill_manual(name='Cultural period',
breaks = c('UP','LSA','MP','MSA','LP','ESA'),
values = c('#F07241','#A70D1F','#A59837','#2E5440','#5D9CA5','#4D4E6B'),
labels = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age')),
coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs',xlim=c(-7500000,8600000), ylim=c(-4500000,8000000), expand=T),
scale_x_continuous(breaks = seq(-180, 180, by = 30)),
scale_y_continuous(breaks = seq(-90, 90, by = 30)),
annotation_scale(location = 'br', width_hint = 0.2),
theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
panel.background = element_rect(color = 'black', fill='#5D9CA5'),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.position='none',
#legend.justification = c(1, 0), legend.position = c(0.99, 0.01),
#legend.background = element_rect(fill='#FFFFFF',
#                                 size=.5, linetype="solid",
#                                 colour ="black"),
#legend.key=element_blank(),
#plot.margin = margin(l=6, t=6, b=6, r=6, 'pt')
))
}
# Figures
## Map data
world <- rnaturalearth::ne_countries(scale = 110, returnclass = 'sf') %>% st_transform(crs=st_crs(4326)) %>% st_make_valid()
offset <- 180-60
polygon <- st_polygon(x = list(rbind(
c(-0.0001 - offset, 90),
c(0 - offset, 90),
c(0 - offset, -90),
c(-0.0001 - offset, -90),
c(-0.0001 - offset, 90)
))) %>%
st_sfc() %>%
st_set_crs(4326)
world <- world %>% st_difference(polygon)
## Figure A
plt11<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=point1, aes(fill=period), color='grey10', shape=21)+
theme_map()
plt11
# Figure C
plt21<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=point2, aes(fill=period), color='grey10', shape=21)+
theme_map()
plt21
# Figure E
plt31<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=point3, aes(fill=period), color='grey10', shape=21)+
theme_map()
plt31
## Figure B
plt12<- ggplot(data=table1)+
theme_pub()+
theme(plot.margin = margin(l=15, t=6, b=6, r=12, 'pt'))
plt12
## Figure D
plt22<- ggplot(data=table2)+
theme_pub()+
theme(plot.margin = margin(l=0, t=6, b=6, r=12, 'pt'))
plt22
## Figure F
plt32<- ggplot(data=table3)+
theme_pub()+
theme(plot.margin = margin(l=13.5, t=6, b=6, r=12, 'pt'))
plt32
# Combine plots ----
plt <- plot_grid(plt11,plt12,plt21,plt22,plt31,plt32,
labels=c('A','B','C','D','E','F'), label_size=10, ncol=2, greedy=F,
align='vh', axis='rtb', rel_widths=c(90,90))
plt
View(table)
View(table1)
library(tidyverse)
library(sf)
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents')
View(shape)
st_bbox(shape)
st_bbox(shape[1])
st_bbox(shape[1,])
st_bbox(shape[CONTINENT=='Africa',])
shape %>% filter(CONTINENT=='Africa') %>% st_bbox()
for(i in shape$CONTINENT){
print(paste(str(i), shape %>% filter(CONTINENT==i) %>% st_bbox()))
}
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents') %>% st_wrap_dateline(options = "WRAPDATELINE=YES", quiet = TRUE)
st_bbox(shape[CONTINENT=='Africa',])
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents') %>% st_wrap_dateline(options = "WRAPDATELINE=YES", quiet = TRUE)
for(i in shape$CONTINENT){
print(paste(str(i), shape %>% filter(CONTINENT==i) %>% st_bbox()))
}
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents') %>% st_wrap_dateline(options = "WRAPDATELINE=NO", quiet = TRUE)
for(i in shape$CONTINENT){
print(paste(str(i), shape %>% filter(CONTINENT==i) %>% st_bbox()))
}
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents') %>% st_wrap_dateline(options = "WRAPDATELINE=NO", quiet = FALSE)
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents') %>% st_wrap_dateline(options = "WRAPDATELINE=YES", quiet = FALSE)
for(i in shape$CONTINENT){
print(paste(str(i), shape %>% filter(CONTINENT==i) %>% st_bbox()))
}
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents', options = "WRAPDATELINE=YES")
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents') %>% st_wrap_dateline(, quiet = FALSE)
shape <- st_read(dsn='C:/data/SANDBOX/pollenclim_bbox', layer='World_Continents') %>% st_wrap_dateline(options = "WRAPDATELINE=YES", quiet = FALSE)
for(i in shape$CONTINENT){
print(paste(str(i), shape %>% filter(CONTINENT==i) %>% st_bbox()))
}
