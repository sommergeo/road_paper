ggsave('fig_coverage/fig_coverage.png', width=180, height=200, units='mm', dpi=300, bg='#FFFFFF')
plt1<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=points, aes(size=n), fill='#A70D1F', color='grey10', shape=21)+
#coord_sf(crs = '+init=epsg:4326', xlim=c(-20, 180), ylim = c(-90, +90), expand=F)+
#coord_sf(crs = '+proj=moll +lon_0=60 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=wink2 +lon_0=60 +lat_1=50.4597762521898 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=eck4 +lon_0=60 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs',xlim=c(-2400000, 180), expand=F)+
coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs',xlim=c(-7500000,8600000), ylim=c(-4500000,8000000), expand=T)+
#coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs', expand=F)+
scale_x_continuous(breaks = seq(-180, 180, by = 30))+
scale_y_continuous(breaks = seq(-90, 90, by = 30))+
scale_size_continuous(name='Number of assemblages\nper locality', breaks=c(1,10,100,1000), labels=c(1,10,100,1000), limits = c(0,1000), range = c(.1, 18))+
#scale_fill_continuous(name='Number of assemblages', low='#A70D1F', high='#A70D1F50', limits = c(0,1000))+
#scale_color_continuous(name='Number of assemblages', low='#FFFFFF10', high='#FFFFFF99', limits = c(0,1000))+
annotation_scale(location = 'bl', width_hint = 0.2) +
theme_pub()+
theme(panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
panel.background = element_rect(color = 'black', fill='#5D9CA5'),
panel.border = element_rect(colour = "black", fill=NA, size=1),
legend.position='right',
plot.margin = margin(l=20, t=0, b=0, r=6, 'pt'))
plt1
top_row <- plot_grid(plt1, labels=c('A'), label_size=10)
full_plot <- plot_grid(top_row, bottom_row, label_size=10, nrow=2, rel_heights = c(2,1), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=200, units='mm', dpi=300, bg='#FFFFFF')
plt1<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=points, aes(size=n), fill='#A70D1F', color='grey10', shape=21)+
#coord_sf(crs = '+init=epsg:4326', xlim=c(-20, 180), ylim = c(-90, +90), expand=F)+
#coord_sf(crs = '+proj=moll +lon_0=60 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=wink2 +lon_0=60 +lat_1=50.4597762521898 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=eck4 +lon_0=60 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs',xlim=c(-2400000, 180), expand=F)+
coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs',xlim=c(-7500000,8600000), ylim=c(-4500000,8000000), expand=T)+
#coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs', expand=F)+
scale_x_continuous(breaks = seq(-180, 180, by = 30))+
scale_y_continuous(breaks = seq(-90, 90, by = 30))+
scale_size_continuous(name='Number of assemblages\nper locality', breaks=c(1,10,100,1000), labels=c(1,10,100,1000), limits = c(0,1000), range = c(.1, 18))+
#scale_fill_continuous(name='Number of assemblages', low='#A70D1F', high='#A70D1F50', limits = c(0,1000))+
#scale_color_continuous(name='Number of assemblages', low='#FFFFFF10', high='#FFFFFF99', limits = c(0,1000))+
annotation_scale(location = 'bl', width_hint = 0.2) +
theme_pub()+
theme(panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
panel.background = element_rect(color = 'black', fill='#5D9CA5'),
panel.border = element_rect(colour = "black", fill=NA, size=1),
legend.position='right',
plot.margin = margin(l=25, t=0, b=0, r=6, 'pt'))
plt1
top_row <- plot_grid(plt1, labels=c('A'), label_size=10)
full_plot <- plot_grid(top_row, bottom_row, label_size=10, nrow=2, rel_heights = c(2,1), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=200, units='mm', dpi=300, bg='#FFFFFF')
plt1<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=points, aes(size=n), fill='#A70D1F', color='grey10', shape=21)+
#coord_sf(crs = '+init=epsg:4326', xlim=c(-20, 180), ylim = c(-90, +90), expand=F)+
#coord_sf(crs = '+proj=moll +lon_0=60 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=wink2 +lon_0=60 +lat_1=50.4597762521898 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=eck4 +lon_0=60 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs',xlim=c(-2400000, 180), expand=F)+
coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs',xlim=c(-7500000,8600000), ylim=c(-4500000,8000000), expand=T)+
#coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs', expand=F)+
scale_x_continuous(breaks = seq(-180, 180, by = 30))+
scale_y_continuous(breaks = seq(-90, 90, by = 30))+
scale_size_continuous(name='Number of assemblages\nper locality', breaks=c(1,10,100,1000), labels=c(1,10,100,1000), limits = c(0,1000), range = c(.1, 18))+
#scale_fill_continuous(name='Number of assemblages', low='#A70D1F', high='#A70D1F50', limits = c(0,1000))+
#scale_color_continuous(name='Number of assemblages', low='#FFFFFF10', high='#FFFFFF99', limits = c(0,1000))+
annotation_scale(location = 'bl', width_hint = 0.2) +
theme_pub()+
theme(panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
panel.background = element_rect(color = 'black', fill='#5D9CA5'),
panel.border = element_rect(colour = "black", fill=NA, size=1),
legend.position='right',
plot.margin = margin(l=23, t=0, b=0, r=6, 'pt'))
plt1
top_row <- plot_grid(plt1, labels=c('A'), label_size=10)
full_plot <- plot_grid(top_row, bottom_row, label_size=10, nrow=2, rel_heights = c(2,1), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=200, units='mm', dpi=300, bg='#FFFFFF')
plt1<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=points, aes(size=n), fill='#A70D1F', color='grey10', shape=21)+
#coord_sf(crs = '+init=epsg:4326', xlim=c(-20, 180), ylim = c(-90, +90), expand=F)+
#coord_sf(crs = '+proj=moll +lon_0=60 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=wink2 +lon_0=60 +lat_1=50.4597762521898 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=eck4 +lon_0=60 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs',xlim=c(-2400000, 180), expand=F)+
coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs',xlim=c(-7500000,8600000), ylim=c(-4500000,8000000), expand=T)+
#coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs', expand=F)+
scale_x_continuous(breaks = seq(-180, 180, by = 30))+
scale_y_continuous(breaks = seq(-90, 90, by = 30))+
scale_size_continuous(name='Number of assemblages\nper locality', breaks=c(1,10,100,1000), labels=c(1,10,100,1000), limits = c(0,1000), range = c(.1, 18))+
#scale_fill_continuous(name='Number of assemblages', low='#A70D1F', high='#A70D1F50', limits = c(0,1000))+
#scale_color_continuous(name='Number of assemblages', low='#FFFFFF10', high='#FFFFFF99', limits = c(0,1000))+
annotation_scale(location = 'bl', width_hint = 0.2) +
theme_pub()+
theme(panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
panel.background = element_rect(color = 'black', fill='#5D9CA5'),
panel.border = element_rect(colour = "black", fill=NA, size=1),
legend.position='right',
plot.margin = margin(l=24, t=0, b=0, r=6, 'pt'))
plt1
# Combine plots
bottom_row <- plot_grid(plt2, plt3, labels = c('B', 'C'), align='hv', axis='tblr', label_size = 10, ncol=2)
bottom_row
top_row <- plot_grid(plt1, labels=c('A'), label_size=10)
full_plot <- plot_grid(top_row, bottom_row, label_size=10, nrow=2, rel_heights = c(2,1), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=200, units='mm', dpi=300)
plt1<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=points, aes(size=n), fill='#A70D1F', color='grey10', shape=21)+
#coord_sf(crs = '+init=epsg:4326', xlim=c(-20, 180), ylim = c(-90, +90), expand=F)+
#coord_sf(crs = '+proj=moll +lon_0=60 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=wink2 +lon_0=60 +lat_1=50.4597762521898 +x_0=0 +y_0=0 +R=6371000 +units=m +no_defs')+
#coord_sf(crs = '+proj=eck4 +lon_0=60 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs',xlim=c(-2400000, 180), expand=F)+
coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs',xlim=c(-7500000,8600000), ylim=c(-4500000,8000000), expand=T)+
#coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs', expand=F)+
scale_x_continuous(breaks = seq(-180, 180, by = 30))+
scale_y_continuous(breaks = seq(-90, 90, by = 30))+
scale_size_continuous(name='Number of assemblages\nper locality', breaks=c(1,10,100,1000), labels=c(1,10,100,1000), limits = c(0,1000), range = c(.1, 18))+
#scale_fill_continuous(name='Number of assemblages', low='#A70D1F', high='#A70D1F50', limits = c(0,1000))+
#scale_color_continuous(name='Number of assemblages', low='#FFFFFF10', high='#FFFFFF99', limits = c(0,1000))+
annotation_scale(location = 'bl', width_hint = 0.2) +
theme_pub()+
theme(panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
panel.background = element_rect(color = 'black', fill='#5D9CA5'),
panel.border = element_rect(colour = "black", fill=NA, size=1),
legend.position='right',
plot.margin = margin(l=24, t=6, b=6, r=6, 'pt'))
plt1
plt2 <- ggplot()+
geom_bar(data=table3, stat = 'identity', aes(y=country_continent.continent, x=value, fill=variable), position=position_dodge2(reverse=T))+
scale_fill_manual(values=c('orange', '#383846'), name='Number of', labels=c('assemblages','localities'))+
scale_x_continuous(limits=c(0,12000), breaks = seq(0,12000,2000))+
labs(x='Count', y='')+
geom_text(data=table3, stat='identity', aes(y=country_continent.continent, x=value, group=variable, label=value), position = position_dodge2(width = .9, reverse=T), hjust=-.1, size=2.8)+
theme_pub()+
theme(legend.position='bottom',
panel.grid.major.y = element_blank(),
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt2
plt3 <- ggplot()+
annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
# Combine plots
bottom_row <- plot_grid(plt2, plt3, labels = c('B', 'C'), align='hv', axis='tblr', label_size = 10, ncol=2)
bottom_row
top_row <- plot_grid(plt1, labels=c('A'), label_size=10)
full_plot <- plot_grid(top_row, bottom_row, nrow=2, rel_heights = c(2,1), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=200, units='mm', dpi=300)
ggsave('fig_coverage/fig_coverage.png', width=180, height=180, units='mm', dpi=300)
ggsave('fig_coverage/fig_coverage.png', width=180, height=160, units='mm', dpi=300)
full_plot <- plot_grid(top_row, bottom_row, nrow=2, rel_heights = c(2,1.5), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=180, units='mm', dpi=300)
ggsave('fig_coverage/fig_coverage.png', width=180, height=190, units='mm', dpi=300)
ggsave('fig_coverage/fig_coverage.png', width=180, height=190, units='mm', dpi=300, bg='white')
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf), fill="#FFD28A")
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf), fill="#FFD28A")+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf), fill="#FFD28A")+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, type=1)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf), fill="#FFD28A")+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=1)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf), fill="#FFD28A")+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=21)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf), fill="#FFD28A")+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
ggsave('fig_coverage/fig_coverage_C.png', width=180, height=180, units='mm', dpi=300)
# Combine plots
bottom_row <- plot_grid(plt2, plt3, labels = c('B', 'C'), align='hv', axis='tblr', label_size = 10, ncol=2)
bottom_row
top_row <- plot_grid(plt1, labels=c('A'), label_size=10)
full_plot <- plot_grid(top_row, bottom_row, nrow=2, rel_heights = c(2,1.5), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=190, units='mm', dpi=300, bg='white')
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf), fill="#FFD28A")+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf), fill="#FFD28A", show.legend = T)+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf, fill='scope'))+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
scale_fill_manual('',
values = '#FFD28A',
guide = guide_legend(override.aes = list(alpha = 1)))
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf, fill='scope'))+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
scale_fill_manual('',
values = '#FFD28A',
guide = guide_legend(override.aes = list(alpha = 1)))+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf, fill='scope'))+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
scale_fill_manual(NULL,
values = '#FFD28A',
guide = guide_legend(override.aes = list(alpha = 1)))+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf, fill='scope'))+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
scale_fill_manual(name=NULL,
values = '#FFD28A',
guide = guide_legend(override.aes = list(alpha = 1)))+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf, fill='scope'))+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
scale_fill_manual(name=NA,
values = '#FFD28A',
guide = guide_legend(override.aes = list(alpha = 1)))+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf, fill='scope'))+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
scale_fill_manual(name=NULL,
values = '#FFD28A',
labels = c('temporal scope'),
guide = guide_legend(override.aes = list(alpha = 1)))+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf, fill='scope'))+
geom_jitter(data=table, aes(x=age_mean, y=age_range), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
scale_fill_manual(name=NULL,
values = '#FFD28A',
labels = c('Temporal scope'),
guide = guide_legend(override.aes = list(alpha = 1)))+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
plt3 <- ggplot()+
#annotate("rect", xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf,  fill = "#FFD28A")+
geom_rect(aes(xmin = 20000, xmax = 3000000, ymin = 0, ymax = Inf, fill='scope'))+
geom_jitter(data=table, aes(x=age_mean, y=age_range, color='date'), alpha=.1, shape=20)+
scale_x_log10(breaks = c(1000, 10000, 100000, 1000000, 6000000),
labels = c(1, 10, 100, 1000, 6000))+
scale_y_log10(breaks = c(1000, 10000, 100000, 1000000, 4000000),
labels = c(1, 10, 100, 1000, 4000))+
#annotation_logticks()+
labs(x='Age (ka BP)', y='Age range (ka)')+
scale_fill_manual(name=NULL,
values = '#FFD28A',
labels = c('Temporal scope'),
guide = guide_legend(override.aes = list(alpha = 1)))+
scale_color_manual(name=NULL,
values = '#000000',
labels = c('Date'),
guide = guide_legend(override.aes = list(alpha = 1)))+
theme_pub()+
theme(legend.position='bottom',
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt3
ggsave('fig_coverage/fig_coverage_C.png', width=180, height=180, units='mm', dpi=300)
# Combine plots
bottom_row <- plot_grid(plt2, plt3, labels = c('B', 'C'), align='hv', axis='tblr', label_size = 10, ncol=2)
bottom_row
top_row <- plot_grid(plt1, labels=c('A'), label_size=10)
full_plot <- plot_grid(top_row, bottom_row, nrow=2, rel_heights = c(2,1.5), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=190, units='mm', dpi=300, bg='white')
plt2 <- ggplot()+
geom_bar(data=table3, stat = 'identity', aes(y=country_continent.continent, x=value, fill=variable), position=position_dodge2(reverse=T))+
scale_fill_manual(values=c('#F07241', '#383846'), name='Number of', labels=c('assemblages','localities'))+
scale_x_continuous(limits=c(0,12000), breaks = seq(0,12000,2000))+
labs(x='Count', y='')+
geom_text(data=table3, stat='identity', aes(y=country_continent.continent, x=value, group=variable, label=value), position = position_dodge2(width = .9, reverse=T), hjust=-.1, size=2.8)+
theme_pub()+
theme(legend.position='bottom',
panel.grid.major.y = element_blank(),
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
plt2
ggsave('fig_coverage/fig_coverage_B.png', width=180, height=180, units='mm', dpi=300)
# Combine plots
bottom_row <- plot_grid(plt2, plt3, labels = c('B', 'C'), align='hv', axis='tblr', label_size = 10, ncol=2)
bottom_row
top_row <- plot_grid(plt1, labels=c('A'), label_size=10)
full_plot <- plot_grid(top_row, bottom_row, nrow=2, rel_heights = c(2,1.5), align='h', axis='l')
full_plot
ggsave('fig_coverage/fig_coverage.png', width=180, height=190, units='mm', dpi=300, bg='white')
library(tidyverse)
library(ggVennDiagram)
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
library(tidyverse)
library(ggVennDiagram)
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
theme_pub <-  function(){
list(theme_bw(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2)))
}
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
low="#deebf7", high = "#3182bd",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
#scale_fill_gradient(name='Number of\nLocalities',
#                    low="#deebf7", high = "#3182bd",
#                    breaks=c(0,200,400,600,800), labels=c(0,200,400,600,800),
#                    limits=c(0,800))+
scale_color_manual(values=c('black','black','black','black'))+
theme_pub()+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
low="#deebf7", high = "#3182bd",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
#scale_fill_gradient(name='Number of\nLocalities',
#                    low="#deebf7", high = "#3182bd",
#                    breaks=c(0,200,400,600,800), labels=c(0,200,400,600,800),
#                    limits=c(0,800))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
