scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
low="#d5dcd8", high="#2e5440",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn_v2.tiff', width=120, height=80, units='mm', dpi=300)
ggsave('fig_venn/fig_venn_v2.png', width=120, height=80, units='mm', dpi=300, bg='white')
library(tidyverse)
library(readr)
# Import data
road_sources <- read_delim("fig_sources/road_sources.csv",
delim = ";", escape_double = FALSE,
col_types = cols(...4 = col_skip()), trim_ws = TRUE)
road_sources <- road_sources %>% filter(publication_view.publication_year != 0) # Remove publications from Jesus' birth year
theme_pub <-  function(){
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
))
}
# Plot timeline
ggplot()+
geom_histogram(data=road_sources, aes(x=publication_view.publication_year), binwidth = 1, fill='#4D4E6B')+
scale_x_continuous(breaks = seq(0, 2030, by = 10), limits=c(1865,2022), expand = c(0,0))+
scale_y_continuous(breaks = c(0, 10, 50, 100, 150, 200), expand = c(0,0))+
labs(x='Year of publication', y='Count')+
theme_pub()+
theme(panel.grid.major.y = element_line(),
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T)
xlsx::write.xlsx(most_cited, 'fig_sources/most_cited.xlsx', sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
lorenz_sections <- data.frame(
t1 <- filter(most_cited, n==1) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n)),
t10 <- filter(most_cited, n>1 & n<=10) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n)),
t50 <- filter(most_cited, n>10 & n<=50) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n))
)
library(tidyverse)
library(readr)
# Import data
road_sources <- read_delim("fig_sources/road_sources.csv",
delim = ";", escape_double = FALSE,
col_types = cols(...4 = col_skip()), trim_ws = TRUE)
road_sources <- road_sources %>% filter(publication_view.publication_year != 0) # Remove publications from Jesus' birth year
theme_pub <-  function(){
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
))
}
# Plot timeline
ggplot()+
geom_histogram(data=road_sources, aes(x=publication_view.publication_year), binwidth = 1, fill='#4D4E6B')+
scale_x_continuous(breaks = seq(0, 2030, by = 10), limits=c(1865,2022), expand = c(0,0))+
scale_y_continuous(breaks = c(0, 10, 50, 100, 150, 200), expand = c(0,0))+
labs(x='Year of publication', y='Count')+
theme_pub()+
theme(panel.grid.major.y = element_line(),
plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'))
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T)
xlsx::write.xlsx(most_cited, 'fig_sources/most_cited.xlsx', sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
lorenz_sections <- data.frame(
t1 <- filter(most_cited, n==1) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n)),
t10 <- filter(most_cited, n>1 & n<=10) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n)),
t50 <- filter(most_cited, n>10 & n<=50) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n))
)
View(most_cited)
View(lorenz_sections)
lorenz_sections <- data.frame(
t1 = filter(most_cited, n==1) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n)),
t10 = filter(most_cited, n>1 & n<=10) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n)),
t50 = filter(most_cited, n>10 & n<=50) %>% summarise(sources=n(), titles=sum(n)) %>% mutate(sources_pc=sources/count(most_cited), titles_pc=titles/sum(most_cited$n))
)
cumsum(mist_cited$n)
cumsum(most_cited$n)
View(cumsum(most_cited$n))
View(cumsum(most_cited$n[10]))
cumsum(most_cited$n[10])
cumsum(most_cited$n)[10]
View(most_cited)
cumsum(most_cited$n)[3]
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T)
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(percentage=count/sum(count))
View(most_cited)
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(percentage=n/sum(n))
View(most_cited)
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(percentage=n*100/sum(n))
View(most_cited)
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(percentage=n*100/sum(n), cumsum = cumsum(n))
View(most_cited)
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(percentage=n*100/sum(n), cumsum = cumsum(n), cumsum_percentage=cumsum/sum(n))
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(percentage=n*100/sum(n), cumsum = cumsum(n), cumsum_percentage=cumsum*100/sum(n))
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n))
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=dense_rank(desc(n)))
View(most_cited)
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=rank(desc(n)))
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=nrow())
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=row_number())
View(most_cited)
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=row_number(), rank_perc=rank/length())
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=row_number(), rank_perc=rank/length(.))
View(most_cited)
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=row_number(), rank_perc=rank/length(rank))
length(most_cited$rank)
xlsx::write.xlsx(most_cited, 'fig_sources/most_cited.xlsx', sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
most_cited$rank[10]
most_cited[10]
most_cited[10,]
library(gglorenz)
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x = 0.626, y = 0.305, xend = 0.726, yend = 0.205), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
View(most_cited)
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x = 0.626, y = 0.305, xend = ran_perc[375], yend = 0.205), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x = 0.626, y = 0.305, xend = rank_perc[375], yend = 0.205), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=desc(row_number()), rank_perc=rank/length(rank))
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x = 0.626, y = 0.305, xend = rank_perc[375], yend = 0.205), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
# Most cited publications
most_cited <- road_sources %>%
count(publication_view.source_title, sort=T) %>%
mutate(perc=n/sum(n), cumsum = cumsum(n), cumsum_perc=cumsum/sum(n), rank=row_number(), rank_perc=rank/length(rank))
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x = 0.626, y = 0.305, xend = 1-rank_perc[375], yend = 0.205), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x = 0.626, y = 0.305, xend = 1-rank_perc[375], yend = cumsum_perc[375]), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x = 0.626, y = 0.305, xend = 1-rank_perc[375], yend=1-cumsum_perc[375]), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x = 0.9-rank_perc[375], y = 0.305, xend = 1-rank_perc[375], yend=1-cumsum_perc[375]), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x=0.9-rank_perc[375], y=0.9-cumsum_perc[375], xend=1-rank_perc[375], yend=1-cumsum_perc[375]), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x = 0.626, y = 0.305, label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(data=most_cited, aes(n), color='#4D4E6B')+
geom_abline(linetype = "dashed", color='black')+
coord_fixed() +
scale_x_continuous(expand = c(0,0), labels = scales::percent_format(accuracy = 1))+
scale_y_continuous(expand = c(0,0),labels = scales::percent_format(accuracy = 1))+
stat_lorenz(desc=F)+
geom_curve(
aes(x=0.9-rank_perc[375], y=0.9-cumsum_perc[375], xend=1-rank_perc[375], yend=1-cumsum_perc[375]), curvature=-0.5,
arrow = arrow(length = unit(4, 'pt'))
)+
geom_text(aes(x=0.9-rank_perc[375],  y=0.9-cumsum_perc[375], label = "Sources\nwith 1 title"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
#geom_segment(aes(x = 0.726, y = 0.265, xend = 0.726, yend = 0.205),
#             arrow = arrow(length = unit(4, "pt")))+
geom_segment(aes(x = 0.855, y = 0.450, xend = 0.955, yend = 0.450),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.855, y = 0.450, label = "Sources\nwith 10 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
geom_segment(aes(x = 0.890, y = 0.667, xend = 0.990, yend = 0.667),
arrow = arrow(length = unit(4, "pt")))+
geom_text(aes(x = 0.890, y = 0.667, label = "Sources\nwith 50 titles"),
hjust = 1.1,
vjust = 0.5,
size = 2.8)+
labs(x = "Cumulative percentage of sources",
y = "Cumulative percentage of titles")+
theme_pub()+
theme(plot.margin = margin(l=6, t=6, b=6, r=6, 'pt'),
panel.border = element_rect(colour = "black", fill=NA, size=1))
