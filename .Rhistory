plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=fct_rev(fct_infreq(astrat.consol))))
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=astrat.consol))
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, -n)))
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))
plot(plt5)
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol26)) #%>%
View(table_cultures)
table_cultures$astrat.consol %>% count()
table_cultures$astrat.consol %>% count(astrat.consol)
table_cultures %>% count(astrat.consol)
table_cultures %>% count(astrat.consol) %>% View()
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) #%>%
table_cultures %>% count(astrat.consol) %>% View()
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
filter(!astrat.consol=='do not use') %>%
count(astrat.consol)
View(table_cultures)
source("C:/data/git/road_paper/fig_archaeology.R", echo=TRUE)
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
filter(!astrat.consol %in% c('do not use', '%Other%')) %>%
count(astrat.consol)
View(table_cultures)
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
filter(!astrat.consol %like% c('do not use', '%Other%')) %>%
count(astrat.consol)
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
filter(!astrat.consol %like% c('do not use', 'Other')) %>%
count(astrat.consol)
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
filter(!astrat.consol %in% c('do not use', 'Other')) %>%
count(astrat.consol)
View(table_cultures)
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic')) %>%
count(astrat.consol)
View(table_cultures)
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic')) %>%
filter(n<10)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))
plot(plt5)
## tidy table
table_cultures <- table  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic')) %>%
filter(n>10)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))
plot(plt5)
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic')) %>%
filter(n>10)
View(table_cultures)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))+
geom_text(aes(label=n, x=n, y=fct_rev(fct_infreq(period))), hjust=-.1, size=2.8)+
labs(x='Count', y='Cultural Period')+
scale_x_continuous(limits=c(0,650), expand = c(0,0))+
scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Cultural Period')+
scale_x_continuous(limits=c(0,650), expand = c(0,0))+
scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Cultural Period')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Cultural Period')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)))+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), color='383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#e7d448')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=90, height=90, units='mm', dpi=300, bg='white')
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=90, height=90, units='mm', dpi=300, bg='white')
## Other stuff
theme_pub <-  function(){
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major.y = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2)
))
}
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major.x = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2)
))
## Other stuff
theme_pub <-  function(){
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major.x = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2)
))
}
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=90, height=90, units='mm', dpi=300, bg='white')
## Other stuff
theme_pub <-  function(){
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major.x = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
axis.ticks = element_blank()
))
}
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
## Other stuff
theme_pub <-  function(){
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major.x = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
axis.ticks = element_blank(),
axis.line.x = element_blank()
))
}
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,250), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=90, height=90, units='mm', dpi=300, bg='white')
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,260), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=90, height=90, units='mm', dpi=300, bg='white')
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Count', y='Culture')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=90, height=90, units='mm', dpi=300, bg='white')
#Figure D
table_period <- table  %>%
count(period) %>%
mutate(column = c(3,3,1,2,2,1))
plt4<- ggplot(data=table_period)+
scale_fill_manual(name='Number of localities',
breaks = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'),
values = c('#F07241','#A70D1F','#A59837','#2E5440','#5D9CA5','#4D4E6B'),
labels = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'))+
geom_col(aes(x=n, y=fct_rev(fct_infreq(period)), fill=period))+
geom_text(aes(label=n, x=n, y=fct_rev(fct_infreq(period))), hjust=-.1, size=2.8)+
labs(x='Count', y='Cultural Period')+
scale_x_continuous(limits=c(0,650), expand = c(0,0))+
scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()+
theme(legend.position='none',
plot.margin = margin(l=1, t=11, b=7, r=6, 'pt'))
plt4
ggsave('fig_archaeology/fig_archaeology_D.png', width=100, height=70, units='mm', dpi=300)
# Combine plots
plt <- plot_grid(plt1,plt2,plt3,plt4,
labels=c('A','B','C','D'), label_size=10, ncol=2, greedy=F,
align='h', axis='tb', rel_widths=c(90,90))
plt
ggsave('fig_archaeology/fig_archaeology.png', width=180, height=150, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology.tiff', width=180, height=150, units='mm', dpi=300, bg='white')
plt4<- ggplot(data=table_period)+
scale_fill_manual(name='Number of localities',
breaks = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'),
values = c('#F07241','#A70D1F','#A59837','#2E5440','#5D9CA5','#4D4E6B'),
labels = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'))+
geom_col(aes(x=n, y=fct_rev(fct_infreq(period)), fill=period))+
geom_text(aes(label=n, x=n, y=fct_rev(fct_infreq(period))), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='Cultural Period')+
scale_x_continuous(limits=c(0,650), expand = c(0,0))+
scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()+
theme(legend.position='none',
plot.margin = margin(l=1, t=11, b=7, r=6, 'pt'))
plt4
ggsave('fig_archaeology/fig_archaeology_D.png', width=100, height=70, units='mm', dpi=300)
# Combine plots
plt <- plot_grid(plt1,plt2,plt3,plt4,
labels=c('A','B','C','D'), label_size=10, ncol=2, greedy=F,
align='h', axis='tb', rel_widths=c(90,90))
plt
ggsave('fig_archaeology/fig_archaeology.png', width=180, height=150, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology.tiff', width=180, height=150, units='mm', dpi=300, bg='white')
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='Culture')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=90, height=90, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=180, height=150, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=90, height=90, units='mm', dpi=300, bg='white')
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Number of localities', y=NA)+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=90, height=90, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=90, height=90, units='mm', dpi=300, bg='white')
# Combine plots
plt <- plot_grid(plt1,plt2,plt3,plt4,
labels=c('A','B','C','D'), label_size=10, ncol=2, greedy=F,
align='h', axis='tb', rel_widths=c(90,90))
# Combine plots
plt <- plot_grid(plt1,plt2,plt3,plt4,
labels=c('A','B','C','D'), label_size=10, ncol=2, greedy=F,
align='h', axis='tb', rel_widths=c(90,90))
plt
ggsave('fig_archaeology/fig_archaeology.png', width=190.5, height=160, units='mm', dpi=300, bg='black')
ggsave('fig_archaeology/fig_archaeology.tiff', width=190.5, height=160, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=132, height=120, units='mm', dpi=300, bg='white')
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=132, height=120, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=132, height=100, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=132, height=100, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=132, height=90, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=132, height=90, units='mm', dpi=300, bg='white')
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic','Lower Paleolithic')) %>%
filter(n>10)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=132, height=90, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=132, height=90, units='mm', dpi=300, bg='white')
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic','Lower Paleolithic')) %>%
filter(n>=10)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic','Lower Paleolithic')) %>%
filter(n>10)
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic','Lower Paleolithic')) %>%
filter(n>=10)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=132, height=90, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=132, height=90, units='mm', dpi=300, bg='white')
library(tidyverse)
library(readr)
library(sf)
library(ggspatial)
library(cowplot)
# Import data
## Localities with astrats
table <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)
table <- table  %>%
mutate(period=archaeological_stratigraphy.cultural_period) %>%
filter(period %in% c('ESA','MSA','LSA','Lower Paleolithic','Middle Paleolithic','Upper Paleolithic')) %>%
mutate(period=recode(period, 'ESA' = 'Early Stone Age', 'MSA'='Middle Stone Age', 'LSA'='Later Stone Age')) %>%
mutate(period = factor(period, levels=c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'))) %>%
na.omit(c(locality.x, locality.y))
## Other stuff
theme_pub <-  function(){
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major.x = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
axis.ticks = element_blank(),
axis.line.x = element_blank()
))
}
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic','Lower Paleolithic', 'Holocene', 'Epipaleolithic', 'Magdalenian')) %>%
filter(n>=10)
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic','Lower Paleolithic', 'Holocene', 'Epipaleolithic', 'Magdalenian')) %>%
filter(n>=10)
# Culutres table
## LUT for astrat consolidation
dict <- readxl::read_excel("fig_archaeology/arch_strat_consol.xlsx",
sheet = "arch_strat_ROAD", skip = 1) %>% select(idarchstrat, consol26='new_a_strat for simple search list 2', consol40='new_a_strat for simple search list 1')
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic','Lower Paleolithic', 'Holocene', 'Epipaleolithic', 'Magdalenian')) %>%
filter(n>=10)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=132, height=90, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=132, height=90, units='mm', dpi=300, bg='white')
