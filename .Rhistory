setdiff(table$locality.country, world$geounit)
## Join
world <- left_join(world, table, by = c("admin" = 'locality.country'))
# Merge ROAD with geodata
## Load geodata
world <- rnaturalearth::ne_countries(scale = 110, returnclass = 'sf') %>% st_transform(crs=st_crs(4326)) %>% st_make_valid()
## Find difference in country names
intersect(table$locality.country, world$admin)
setdiff(table$locality.country, world$admin)
setdiff(table$locality.country, world$geounit)
world$admin
## Align countries with natural earth data (i will regret this)
table <- table %>% mutate(locality.country=recode(locality.country,
"Congo, Democratic Republic of the [Zaire]"='Democratic Republic of the Congo',
'Congo, Republic of the' = 'Democratic Republic of the Congo',
'Eswatini' = 'Swaziland',
'Gibraltar' = 'United Kingdom',
'Jersey' = 'United Kingdom',
'Korea, North' = 'North Korea',
'Korea, South' = 'South Korea',
'Serbia'= 'Republic of Serbia',
'North Macedonia'= 'Macedonia',
'Tanzania'='United Republic of Tanzania',
'Timor-Leste'='East Timor'))
## Join
world <- left_join(world, table, by = c("admin" = 'locality.country'))
## Prepare geodata
offset <- 180-60
polygon <- st_polygon(x = list(rbind(
c(-0.0001 - offset, 90),
c(0 - offset, 90),
c(0 - offset, -90),
c(-0.0001 - offset, -90),
c(-0.0001 - offset, 90)
))) %>%
st_sfc() %>%
st_set_crs(4326)
world <- world %>% st_difference(polygon)
## Map
ggplot()+
geom_sf(data=world, aes(fill=year))
color_gradient <- c('#ffd28a','#fec388','#fab587','#f4a888','#eb9b89','#e0908b','#d4868c','#c57d8d','#b5758c','#a46e8b','#926887','#806183','#6f5b7c','#5d5574','#4d4e6b') #https://colordesigner.io/gradient-generator/?mode=lch#fafa6e-2A4858
plt1<- ggplot()+
geom_sf(data=world, aes(fill=factor(year), color=factor(year)), lwd=.01)+
coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs',xlim=c(-7500000,8600000), ylim=c(-4500000,8000000), expand=T)+
scale_x_continuous(breaks = seq(-180, 180, by = 30))+
scale_y_continuous(breaks = seq(-90, 90, by = 30))+
scale_color_manual(values=rev(color_gradient), na.value = '#DDDDDD', breaks=seq(2009,2023))+
scale_fill_manual(values=rev(color_gradient), na.value = '#DDDDDD', breaks=seq(2009,2023))+
#scale_fill_scico(
#  palette = 'batlow', begin = 0.1, limits = c(2009, 2022),
#name = 'Start', breaks = seq(2009,2022),
#guide = guide_colorsteps(barwidth = 20, barheight = .5,
#                         title.position = "top", title.hjust = 0.5, show.limits = TRUE)
#) +
#scale_color_scico(
#  palette = 'batlow', begin = 0.1, limits = c(2009, 2022),
#name = 'Start', breaks = seq(2009,2022),
#guide = guide_colorsteps(barwidth = 20, barheight = .5,
#                         title.position = "top", title.hjust = 0.5, show.limits = TRUE)
#) +
annotation_scale(location = 'bl', width_hint = 0.2) +
theme_pub()+
theme(panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
#panel.background = element_rect(color = 'black', fill='#5D9CA5'),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
#legend.position='bottom',
legend.position='None',
#legend.justification = c(1, 0), legend.position = c(0.99, 0.01),
#legend.title = element_text(colour="black", size=8),
#legend.text = element_text(colour="black", size=8),
#legend.background = element_rect(fill='#FFFFFF',
#                                 size=.5, linetype="solid",
#                                 colour ="black"),
#legend.key=element_blank(),
plot.margin = margin(l=12, t=6, b=6, r=12, 'pt'))
plt1
ggsave('fig_schedule/fig_schedule_A.png', width=180, height=180, units='mm', dpi=300)
# Timeline ----
year_breaks <- seq(as.Date("2009-01-01"), as.Date("2024-01-01"), "years")
year_labels <- seq(as.Date("2009-01-01"), as.Date("2024-01-01"), "2 years")
quarter_breaks <- seq(as.Date("2009-01-01"), as.Date("2024-01-01"), "quarters")
plt2 <- ggplot()+
geom_histogram(data=road_schedule, aes(x=locality.created, fill=cut(locality.created, breaks=year_breaks)), breaks=quarter_breaks)+
scale_fill_manual(values=rev(color_gradient), breaks=year_breaks)+
scale_x_date(breaks=year_labels, date_labels = "%Y", limits = as.Date(c('2008-01-01','2023-12-31')), expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
labs(x='Year', y='Number of assemblages created')+
theme_pub()+
theme(panel.grid.major.y = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
legend.position='None',
plot.margin = margin(l=12, t=6, b=6, r=12, 'pt'))
plt2
ggsave('fig_schedule/fig_schedule_B.png', width=180, height=180, units='mm', dpi=300)
# Combine plots ----
plt <- plot_grid(plt1, plt2, labels = c('A', 'B'), align='h', axis='tb', label_size = 10, ncol=2, rel_widths = c(1,0.74))
plt
ggsave('fig_schedule/fig_schedule.png', width=190.5, height=80, units='mm', dpi=300, bg='white')
ggsave('fig_schedule/fig_schedule.tiff', width=190.5, height=80, units='mm', dpi=300, bg='white')
ggsave('fig_schedule/fig_schedule.pdf', width=190.5, height=80, units='mm', bg='white')
library(tidyverse)
library(readr)
library(sf)
library(ggspatial)
library(cowplot)
# Import data
## Localities with astrats
table <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)
table <- table  %>%
mutate(period=archaeological_stratigraphy.cultural_period) %>%
filter(period %in% c('ESA','MSA','LSA','Lower Paleolithic','Middle Paleolithic','Upper Paleolithic')) %>%
mutate(period=recode(period, 'ESA' = 'Early Stone Age', 'MSA'='Middle Stone Age', 'LSA'='Later Stone Age')) %>%
mutate(period = factor(period, levels=c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'))) %>%
na.omit(c(locality.x, locality.y))
## Other stuff
theme_pub <-  function(){
list(theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major.x = element_line(color = '#CCCCCC', linetype = 'solid', size = 0.4),
axis.ticks = element_blank()
))
}
# Maps
## Split table
table1 <- table %>% filter(period %in% c('Later Stone Age','Upper Paleolithic'))
point1 <- st_as_sf(x = table1, coords = c('locality.x', 'locality.y'), crs = st_crs(4326))
table2 <- table %>% filter(period %in% c('Middle Stone Age','Middle Paleolithic'))
point2 <- st_as_sf(x = table2, coords = c('locality.x', 'locality.y'), crs = st_crs(4326))
table3 <- table %>% filter(period %in% c('Early Stone Age','Lower Paleolithic'))
point3 <- st_as_sf(x = table3, coords = c('locality.x', 'locality.y'), crs = st_crs(4326))
## Map template
theme_map <-  function(){
list(scale_fill_manual(name='Cultural period',
breaks = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'),
values = c('#F07241','#A70D1F','#A59837','#2E5440','#5D9CA5','#4D4E6B'),
labels = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age')),
coord_sf(crs = '+proj=natearth2 +lon_0=60 +x_0=0 +y_0=0 +R=6371008.7714 +units=m +no_defs +type=crs',xlim=c(-7500000,8600000), ylim=c(-4500000,8000000), expand=T),
scale_x_continuous(breaks = seq(-180, 180, by = 30)),
scale_y_continuous(breaks = seq(-90, 90, by = 30)),
annotation_scale(location = 'br', width_hint = 0.2),
theme_classic(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=8), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8),
panel.grid.major = element_line(color = '#DDDDDD', linetype = 'solid', size = 0.2),
panel.background = element_rect(color = 'black', fill='#5D9CA5'),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.position='none',
#legend.justification = c(1, 0), legend.position = c(0.99, 0.01),
#legend.background = element_rect(fill='#FFFFFF',
#                                 size=.5, linetype="solid",
#                                 colour ="black"),
#legend.key=element_blank(),
#plot.margin = margin(l=6, t=6, b=6, r=6, 'pt')
))
}
## Map data
world <- rnaturalearth::ne_countries(scale = 110, returnclass = 'sf') %>% st_transform(crs=st_crs(4326)) %>% st_make_valid()
offset <- 180-60
polygon <- st_polygon(x = list(rbind(
c(-0.0001 - offset, 90),
c(0 - offset, 90),
c(0 - offset, -90),
c(-0.0001 - offset, -90),
c(-0.0001 - offset, 90)
))) %>%
st_sfc() %>%
st_set_crs(4326)
world <- world %>% st_difference(polygon)
# Cultures table
## LUT for astrat consolidation
dict <- readxl::read_excel("fig_archaeology/arch_strat_consol.xlsx",
sheet = "arch_strat_ROAD", skip = 1) %>% select(idarchstrat, consol26='new_a_strat for simple search list 2', consol40='new_a_strat for simple search list 1')
## tidy table
table_cultures <- read_delim("fig_archaeology/road_archaeology.csv",
delim = ";", escape_double = FALSE, trim_ws = TRUE) %>% select(-...7)  %>%
mutate(astrat.consol=plyr::mapvalues(archaeological_stratigraphy.idarchstrat, from=dict$idarchstrat, to=dict$consol40)) %>%
count(astrat.consol) %>%
filter(!astrat.consol %in% c('do not use', 'Other Early Stone Age','Other Late Stone Age','Other Middle Paleolithic','Other Middle Stone Age','Other Upper Paleolithic','Lower Paleolithic', 'Holocene', 'Epipaleolithic', 'Magdalenian')) %>%
filter(n>=10)
plt5 <- ggplot(data=table_cultures)+
geom_col(aes(x=n, y=reorder(astrat.consol, n)), fill='#383846')+
geom_text(aes(label=n, x=n, y=reorder(astrat.consol, n)), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='')+
scale_x_continuous(limits=c(0,270), expand = c(0,0))+
#scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()
plot(plt5)
ggsave('fig_archaeology/fig_archaeology_cultures.png', width=132, height=90, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.tiff', width=132, height=90, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology_cultures.pdf', width=132, height=90, units='mm', bg='white')
# Figure A (Map)
plt1<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=point1, aes(fill=period), color='grey10', shape=21)+
theme_map()
plt1
# Figure B (Map)
plt2<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=point2, aes(fill=period), color='grey10', shape=21)+
theme_map()
# Figure C (Map)
plt3<- ggplot()+
geom_sf(data=world, color = 'white', fill = '#FFD28A', size=0.2)+
geom_sf(data=point3, aes(fill=period), color='grey10', shape=21)+
theme_map()
#Figure D
table_period <- table  %>%
count(period) %>%
mutate(column = c(3,3,1,2,2,1))
plt4<- ggplot(data=table_period)+
scale_fill_manual(name='Number of localities',
breaks = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'),
values = c('#F07241','#A70D1F','#A59837','#2E5440','#5D9CA5','#4D4E6B'),
labels = c('Upper Paleolithic','Later Stone Age','Middle Paleolithic','Middle Stone Age','Lower Paleolithic','Early Stone Age'))+
geom_col(aes(x=n, y=fct_rev(fct_infreq(period)), fill=period))+
geom_text(aes(label=n, x=n, y=fct_rev(fct_infreq(period))), hjust=-.1, size=2.8)+
labs(x='Number of localities', y='Cultural Period')+
scale_x_continuous(limits=c(0,700), expand = c(0,0))+
scale_y_discrete(labels = function(x) str_wrap(x, width = 19))+
theme_pub()+
theme(legend.position='none',
plot.margin = margin(l=1, t=11, b=7, r=6, 'pt'))
plt4
# Combine plots
plt <- plot_grid(plt1,plt2,plt3,plt4,
labels=c('A','B','C','D'), label_size=10, ncol=2, greedy=F,
align='h', axis='tb', rel_widths=c(90,90))
plt
ggsave('fig_archaeology/fig_archaeology.png', width=190.5, height=160, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology.tiff', width=190.5, height=160, units='mm', dpi=300, bg='white')
ggsave('fig_archaeology/fig_archaeology.pdf', width=190.5, height=160, units='mm', bg='white')
library(tidyverse)
library(ggVennDiagram)
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#ffd28a", high="#4d4e6b",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn.tiff', width=132, height=85, units='mm', dpi=300)
ggsave('fig_venn/fig_venn.png', width=132, height=85, units='mm', dpi=300, bg='white')
ggsave('fig_venn/fig_venn.pdf', width=132, height=85, units='mm')
# Stats ----
venn <- Venn(x)
data <- process_data(venn)
stat_categories <- lengths(x)  # number of sites per category
stat_total <- c(x$A, x$B, x$C, x$D) %>% unique() %>% length() # number of sites in total category
stat_total <- c(x$A, x$B, x$C, x$D) %>% unique() %>% length() # number of sites in total category
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
# Stats ----
venn <- Venn(x)
data <- process_data(venn)
stat_total <- c(x$A, x$B, x$C, x$D) %>% unique() %>% length() # number of sites in total category
x$A %>% length() # archaeological sites
x$B %>% length() # human sites
x$C %>% length() # plant sites
x$D %>% length() # faunal sites
x$A/stat_total
x$A %>% length()/stat_total
x$B %>% length()/stat_total
stat_double+stat_triple+stat_quadruple  # More than 1 discipline
# Stats ----
venn <- Venn(x)
data <- process_data(venn)
stat_single <- data@region %>% filter(id %in% c(1,2,3,4)) %>% pull(count) %>% sum()   # number of loclaities with 1 category
stat_double <- data@region %>% filter(id %in% c(12,13,14,23,24,34)) %>% pull(count) %>% sum()   # number of loclaities with 2 categories
stat_triple <- data@region %>% filter(id %in% c(123,124,134,234)) %>% pull(count) %>% sum()   # number of loclaities with 3 categories
stat_quadruple <- data@region %>% filter(id %in% c(1234)) %>% pull(count) %>% sum()   # number of loclaities with 4 categories
stat_double+stat_triple+stat_quadruple  # More than 1 discipline
(stat_double+stat_triple+stat_quadruple)/stat_total # More than 1 discipline
stat_double+stat_triple+stat_quadruple/stat_total  # More than 1 discipline
(stat_double+stat_triple+stat_quadruple)/stat_total  # More than 1 discipline
stat_double+stat_triple+stat_quadruple  # More than 1 discipline
(stat_double+stat_triple+stat_quadruple)/stat_total # More than 1 discipline
stat_double <- data@region %>% filter(id %in% c(12,13,14,23,24,34)) %>% pull(count) %>% sum()   # number of loclaities with 2 categories
stat_triple/stat_total
stat_quadruple/stat_total
library(tidyverse)
library(ggVennDiagram)
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#ffd28a", high="#4d4e6b",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn.tiff', width=132, height=85, units='mm', dpi=300)
ggsave('fig_venn/fig_venn.png', width=132, height=85, units='mm', dpi=300, bg='white')
ggsave('fig_venn/fig_venn.pdf', width=132, height=85, units='mm')
# Stats ----
venn <- Venn(x)
data <- process_data(venn)
stat_total <- c(x$A, x$B, x$C, x$D) %>% unique() %>% length() # number of sites in total category
library(tidyverse)
library(ggVennDiagram)
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#ffd28a", high="#4d4e6b",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn.tiff', width=132, height=85, units='mm', dpi=300)
ggsave('fig_venn/fig_venn.png', width=132, height=85, units='mm', dpi=300, bg='white')
ggsave('fig_venn/fig_venn.pdf', width=132, height=85, units='mm')
# Stats ----
venn <- Venn(x)
data <- process_data(venn)
stat_total <- c(x$A, x$B, x$C, x$D) %>% unique() %>% length() # number of sites in total category
x$A %>% length() # archaeological sites
stat_total <- c(x$A, x$B, x$C, x$D) %>% unique() %>% length() # number of sites in total category
library(tidyverse)
library(ggVennDiagram)
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#ffd28a", high="#4d4e6b",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
library(tidyverse)
library(ggVennDiagram)
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#ffd28a", high="#4d4e6b",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn.tiff', width=132, height=85, units='mm', dpi=300)
ggsave('fig_venn/fig_venn.png', width=132, height=85, units='mm', dpi=300, bg='white')
ggsave('fig_venn/fig_venn.pdf', width=132, height=85, units='mm')
# Stats ----
venn <- Venn(x)
data <- process_data(venn)
stat_total <- c(x$A, x$B, x$C, x$D) %>% unique() %>% length() # number of sites in total category
x$A %>% length() # archaeological sites
x$B %>% length() # human sites
x$C %>% length() # plant sites
x$D %>% length() # faunal sites
stat_single <- data@region %>% filter(id %in% c(1,2,3,4)) %>% pull(count) %>% sum()   # number of loclaities with 1 category
stat_double <- data@region %>% filter(id %in% c(12,13,14,23,24,34)) %>% pull(count) %>% sum()   # number of loclaities with 2 categories
library(tidyverse)
library(ggVennDiagram)
x <- list(
A = read_csv("fig_venn/ListeA_technologyTypologyRawMatFunctionSymbolicFeatureMisc.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
B = read_csv("fig_venn/ListeB_humanRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
C = read_csv("fig_venn/ListeC_plantRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1,
D = read_csv("fig_venn/ListeD_paleofauna_animalRemains.csv",
col_names = FALSE, locale = locale(encoding = "ASCII"))$X1
)
# Venn diagram ----
ggVennDiagram(x, set_color = 'black', label='both', set_size=3, label_size = 2, edge_size = 0.5,
category.names = c('Cultural remains', 'Human remains', 'Plant remains', 'Faunal remains'))+
scale_x_continuous(expand = expansion(mult = .2))+
scale_y_continuous(expand = expansion(mult = .2))+
scale_fill_gradient(name='Number of\nLocalities',
#low="#ffd28a", high="#4d4e6b",
low='#FFD28A', high='#A70D1F', space = "Lab",
trans='log', breaks=c(1, 10,100,1000), labels=c(1,10,100,1000),
limits=c(1,1000))+
scale_color_manual(values=c('black','black','black','black'))+
theme(text=element_text(size=8), #change font size of all text
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=8), #change font size of legend text
legend.title=element_text(size=8))
ggsave('fig_venn/fig_venn.tiff', width=132, height=85, units='mm', dpi=300)
ggsave('fig_venn/fig_venn.png', width=132, height=85, units='mm', dpi=300, bg='white')
ggsave('fig_venn/fig_venn.pdf', width=132, height=85, units='mm')
# Stats ----
venn <- Venn(x)
data <- process_data(venn)
stat_total <- c(x$A, x$B, x$C, x$D) %>% unique() %>% length() # number of sites in total category
x$A %>% length() # archaeological sites
x$B %>% length() # human sites
x$C %>% length() # plant sites
x$D %>% length() # faunal sites
stat_single <- data@region %>% filter(id %in% c(1,2,3,4)) %>% pull(count) %>% sum()   # number of loclaities with 1 category
stat_double <- data@region %>% filter(id %in% c(12,13,14,23,24,34)) %>% pull(count) %>% sum()   # number of loclaities with 2 categories
stat_double/stat_total
stat_triple <- data@region %>% filter(id %in% c(123,124,134,234)) %>% pull(count) %>% sum()   # number of loclaities with 3 categories
stat_triple/stat_total
stat_quadruple <- data@region %>% filter(id %in% c(1234)) %>% pull(count) %>% sum()   # number of loclaities with 4 categories
stat_quadruple/stat_total
stat_double+stat_triple+stat_quadruple  # More than 1 discipline
(stat_double+stat_triple+stat_quadruple)/stat_total # More than 1 discipline
stat_single <- data@region %>% filter(id %in% c(1,2,3,4)) %>% pull(count) %>% sum()   # number of loclaities with 1 category
stat_double <- data@region %>% filter(id %in% c(12,13,14,23,24,34)) %>% pull(count) %>% sum()   # number of loclaities with 2 categories
stat_double+stat_triple+stat_quadruple  # More than 1 discipline
(stat_double+stat_triple+stat_quadruple)/stat_total # More than 1 discipline
stat_double/stat_total
stat_triple <- data@region %>% filter(id %in% c(123,124,134,234)) %>% pull(count) %>% sum()   # number of loclaities with 3 categories
stat_triple/stat_total
stat_quadruple <- data@region %>% filter(id %in% c(1234)) %>% pull(count) %>% sum()   # number of loclaities with 4 categories
stat_quadruple/stat_total
ggsave('fig_venn/fig_venn.tiff', width=132, height=85, units='mm', dpi=300)
ggsave('fig_venn/fig_venn.png', width=132, height=85, units='mm', dpi=300, bg='white')
ggsave('fig_venn/fig_venn.pdf', width=132, height=85, units='mm')
